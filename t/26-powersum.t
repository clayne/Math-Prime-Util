#!/usr/bin/env perl
use strict;
use warnings;

use Test::More;
use Math::Prime::Util qw/powersum/;

my $usexs = Math::Prime::Util::prime_get_config->{'xs'};
my $extra = defined $ENV{EXTENDED_TESTING} && $ENV{EXTENDED_TESTING};

plan tests => 3 + 3 + 2 + 4;

is_deeply([map { powersum(0,$_) } 0..9], [map { 0 } 0..9], "powersum(0,n) = 0");
is_deeply([map { powersum(1,$_) } 0..9], [map { 1 } 0..9], "powersum(1,n) = 1");
is_deeply([map { powersum($_,0) } 1..9], [map { $_ } 1..9], "powersum(n,0) = 1 for n>0");

is(powersum(10,0),  10, "powersum(10,0)=10");
is(powersum(10,1),  55, "powersum(10,1)=55");
is(powersum(10,2), 385, "powersum(10,2)=385");

is_deeply([map { powersum(16,$_) } 0..15], [qw/16 136 1496 18496 243848 3347776 47260136 680856256 9961449608 147520415296 2206044295976 33254351828416 504635269460168 7701103353860416 118091609375661416 1818399978159990976/], "powersum(16,0..15)");
is_deeply([map { powersum(1711,$_) } 0..9], [qw/1711 1464616 1671126856 2145100027456 2937070623367384 4188996380716653376 6145256641557655809016 9202904066587083191010496 14000681533539207660658782424 21565944278446437945896721933376/], "powersum(1711,0..9)");

# From Math::AnyNum tests
is(powersum(97, 20),   '27930470253682554320726764539206479400753', "powersum(97,20)");
is(powersum(1234, 13), '1363782530586069716227147685797600627310545', "powersum(1234,13)");
is(powersum(30, 80),   '15824906698911682552620450221533100599157410235977820404994404262610329210567189683421455768203096083923986638110352399', "powersum(30,80)");
is(powersum('36893488147419103232', 6), '13290765244262525999877070971093849105865118528347431876799549931828154109852970889789225381341531108777505296823405714971493113182289920', "powersum(36893488147419103232,6)");
